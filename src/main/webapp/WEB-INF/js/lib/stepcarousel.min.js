//** Step Carousel Viewer- (c) Dynamic Drive DHTML code library: http://www.dynamicdrive.com
//** Script Download/ http://www.dynamicdrive.com/dynamicindex4/stepcarousel.htm
//** Usage Terms: http://www.dynamicdrive.com/notice.htm
//** Current version 1.91 (Aug 15th, 11'): See http://www.dynamicdrive.com/dynamicindex4/stepcarouselchangelog.txt for details

jQuery.noConflict();var stepcarousel={ajaxloadingmsg:'<div style="margin: 1em; font-weight: bold"><img src="ajaxloadr.gif" style="vertical-align: middle" /> Fetching Content. Please wait...</div>',defaultbuttonsfade:0,configholder:{},getCSSValue:function(a){return a=="auto"?0:parseInt(a)},getremotepanels:function(a,b){b.$belt.html(this.ajaxloadingmsg);a.ajax({url:b.contenttype[1],async:true,error:function(a){b.$belt.html("Error fetching content.<br />Server Response: "+a.responseText)},success:function(c){b.$belt.html(c);b.$panels=b.$gallery.find("."+b.panelclass);stepcarousel.alignpanels(a,b)}})},getoffset:function(a,b){return a.offsetParent?a[b]+this.getoffset(a.offsetParent,b):a[b]},getCookie:function(a){var b=new RegExp(a+"=[^;]+","i");if(document.cookie.match(b))return document.cookie.match(b)[0].split("=")[1];return null},setCookie:function(a,b){document.cookie=a+"="+b},fadebuttonsinstantly:function(a,b){this.fadebuttonswithtime(a,b,0)},fadebuttons:function(a,b){this.fadebuttonswithtime(a,b,"fast")},fadebuttonswithtime:function(a,b,c){var d=b==0?function(){$(this).css("visibility","hidden")}:function(){$(this).css("visibility","visible")};jQuery("#leftArrowNav").fadeTo(c,b==0?this.defaultbuttonsfade:1,d);var e=b==a.lastvisiblepanel?function(){$(this).css("visibility","hidden")}:function(){$(this).css("visibility","visible")};jQuery("#rightArrowNav").fadeTo(c,b==a.lastvisiblepanel?this.defaultbuttonsfade:1,e);if(b==a.lastvisiblepanel){stepcarousel.stopautostep(a)}},addnavbuttons:function(a,b,c){jQuery("#leftArrowNav").attr("innerHTML","");b.$leftnavbutton=a('<img style="margin-top: 130px;" src="'+b.defaultbuttons.leftnav[0]+'">').css({zIndex:50,position:"absolute",cursor:"hand",cursor:"pointer",filter:"inherit",height:"58px"}).attr({title:""}).appendTo("#leftArrowNav");jQuery("#rightArrowNav").attr("innerHTML","");b.$rightnavbutton=a('<img style="margin-top: 130px;" src="'+b.defaultbuttons.rightnav[0]+'">').css({zIndex:50,position:"absolute",cursor:"hand",cursor:"pointer",filter:"inherit",height:"58px"}).attr({title:""}).appendTo("#rightArrowNav");b.$leftnavbutton.bind("click",function(){stepcarousel.stepBy(b.galleryid,-b.defaultbuttons.moveby)});b.$rightnavbutton.bind("click",function(){stepcarousel.stepBy(b.galleryid,b.defaultbuttons.moveby)});if(b.panelbehavior.wraparound==false){this.fadebuttonsinstantly(b,c)}return b.$leftnavbutton.add(b.$rightnavbutton)},alignpanels:function(a,b){var c=0;b.paneloffsets=[c];b.panelwidths=[];b.$panels.each(function(d){var e=a(this);e.css({"float":"none",position:"absolute",left:c+"px"});e.bind("click",function(a){return b.onpanelclick(a.target)});c+=stepcarousel.getCSSValue(e.css("marginRight"))+parseInt(e.get(0).offsetWidth||e.css("width"));b.paneloffsets.push(c);b.panelwidths.push(c-b.paneloffsets[b.paneloffsets.length-2])});b.paneloffsets.pop();var d=0;var e=b.$panels.length-1;b.lastvisiblepanel=e;for(var f=b.$panels.length-1;f>=0;f--){d+=f==e?b.panelwidths[e]:b.paneloffsets[f+1]-b.paneloffsets[f];if(b.gallerywidth>d){b.lastvisiblepanel=f}}b.$belt.css({width:c+"px"});b.currentpanel=b.panelbehavior.persist?parseInt(this.getCookie(b.galleryid+"persist")):0;b.currentpanel=typeof b.currentpanel=="number"&&b.currentpanel<b.$panels.length?b.currentpanel:0;var g=b.paneloffsets[b.currentpanel]+(b.currentpanel==0?0:b.beltoffset);b.$belt.css({left:-g+"px"});if(b.defaultbuttons.enable==true){var h=this.addnavbuttons(a,b,b.currentpanel);a(window).bind("load resize",function(){b.offsets={left:stepcarousel.getoffset(b.$gallery.get(0),"offsetLeft"),top:stepcarousel.getoffset(b.$gallery.get(0),"offsetTop")}})}if(b.autostep&&b.autostep.enable){var i=b.$gallery.add(typeof h!="undefined"?h:null);i.bind("click",function(){b.autostep.status="stopped";stepcarousel.stopautostep(b)});i.hover(function(){stepcarousel.stopautostep(b);b.autostep.hoverstate="over"},function(){if(b.steptimer&&b.autostep.hoverstate=="over"&&b.autostep.status!="stopped"){b.steptimer=setInterval(function(){stepcarousel.autorotate(b.galleryid)},b.autostep.pause);b.autostep.hoverstate="out"}});b.steptimer=setInterval(function(){stepcarousel.autorotate(b.galleryid)},b.autostep.pause)}this.createpaginate(a,b);this.statusreport(b.galleryid);b.oninit();b.onslideaction(this)},stepTo:function(a,b){var c=stepcarousel.configholder[a];if(typeof c=="undefined"){return}stepcarousel.stopautostep(c);var b=Math.min(b-1,c.paneloffsets.length-1);var d=c.paneloffsets[b]+(b==0?0:c.beltoffset);if(c.panelbehavior.wraparound==false&&c.defaultbuttons.enable==true){this.fadebuttons(c,b)}c.$belt.animate({left:-d+"px"},c.panelbehavior.speed,function(){c.onslideaction(this)});c.currentpanel=b;this.statusreport(a)},stepBy:function(a,b,c){var d=stepcarousel.configholder[a];if(typeof d=="undefined"){return}if(!c)stepcarousel.stopautostep(d);var e=b>0?"forward":"back";var f=d.currentpanel+b;if(d.panelbehavior.wraparound==false){f=e=="back"&&f<=0?0:e=="forward"?Math.min(f,d.lastvisiblepanel):f;if(d.defaultbuttons.enable==true){stepcarousel.fadebuttons(d,f)}}else{if(f>d.lastvisiblepanel&&e=="forward"){f=d.currentpanel<d.lastvisiblepanel?d.lastvisiblepanel:0}else if(f<0&&e=="back"){f=d.currentpanel>0?0:d.lastvisiblepanel}}var g=d.paneloffsets[f]+(f==0?0:d.beltoffset);if(d.panelbehavior.wraparound==true&&d.panelbehavior.wrapbehavior=="pushpull"&&(f==0&&e=="forward"||d.currentpanel==0&&e=="back")){d.$belt.animate({left:-d.paneloffsets[d.currentpanel]-(e=="forward"?100:-30)+"px"},"normal",function(){d.$belt.animate({left:-g+"px"},d.panelbehavior.speed,function(){d.onslideaction(this)})})}else d.$belt.animate({left:-g+"px"},d.panelbehavior.speed,function(){d.onslideaction(this)});d.currentpanel=f;this.statusreport(a)},autorotate:function(a){var b=stepcarousel.configholder[a];b.$belt.stop(true,true);this.stepBy(a,b.autostep.moveby,true)},stopautostep:function(a){clearTimeout(a.steptimer)},statusreport:function(a){var b=stepcarousel.configholder[a];if(b.statusvars.length==3){var c=b.currentpanel;var d=0;for(var e=c;e<b.paneloffsets.length;e++){d+=b.panelwidths[e];if(d>b.gallerywidth){break}}c+=1;e=e+1==c?c:e;var f=[c,e,b.panelwidths.length];for(var g=0;g<b.statusvars.length;g++){window[b.statusvars[g]]=f[g];b.$statusobjs[g].text(f[g]+" ")}}stepcarousel.selectpaginate(jQuery,a)},createpaginate:function(a,b){if(b.$paginatediv.length==1){var c=b.$paginatediv.find('img["data-over"]:eq(0)');var d=[],e=[],f=[],g=c.attr("data-moveby")||1;var h=(g==1?0:1)+Math.floor((b.lastvisiblepanel+1)/g);var i=a("<div>").append(c.clone()).html();srcs=[c.attr("src"),c.attr("data-over"),c.attr("data-select")];for(var j=0;j<h;j++){var k=Math.min(j*g,b.lastvisiblepanel);f.push(i.replace(/>$/,' data-index="'+j+'" data-moveto="'+k+'" title="Move to Panel '+(k+1)+'">')+"\n");d.push(k)}var l=a("<span></span>").replaceAll(c).append(f.join("")).find("img");l.css({cursor:"pointer"});b.$paginatediv.bind("click",function(c){var d=a(c.target);if(d.is("img")&&d.attr("data-over")){stepcarousel.stepTo(b.galleryid,parseInt(d.attr("data-moveto"))+1)}});b.$paginatediv.bind("mouseover mouseout",function(c){var d=a(c.target);if(d.is("img")&&d.attr("data-over")){if(parseInt(d.attr("data-index"))!=b.pageinfo.curselected)d.attr("src",srcs[c.type=="mouseover"?1:0])}});b.pageinfo={controlpoints:d,$controls:l,srcs:srcs,prevselected:null,curselected:null}}},selectpaginate:function(a,b){var c=stepcarousel.configholder[b];if(c.$paginatediv.length==1){for(var d=0;d<c.pageinfo.controlpoints.length;d++){if(c.pageinfo.controlpoints[d]<=c.currentpanel)c.pageinfo.curselected=d}if(typeof c.pageinfo.prevselected!=null)c.pageinfo.$controls.eq(c.pageinfo.prevselected).attr("src",c.pageinfo.srcs[0]);c.pageinfo.$controls.eq(c.pageinfo.curselected).attr("src",c.pageinfo.srcs[2]);c.pageinfo.prevselected=c.pageinfo.curselected}},loadcontent:function(a,b){var c=stepcarousel.configholder[a];c.contenttype=["ajax",b];stepcarousel.stopautostep(c);stepcarousel.resetsettings($,c);stepcarousel.init(jQuery,c)},init:function(a,b){b.gallerywidth=b.$gallery.width();b.offsets={left:stepcarousel.getoffset(b.$gallery.get(0),"offsetLeft"),top:stepcarousel.getoffset(b.$gallery.get(0),"offsetTop")};b.$belt=b.$gallery.find("."+b.beltclass);b.$panels=b.$gallery.find("."+b.panelclass);b.panelbehavior.wrapbehavior=b.panelbehavior.wrapbehavior||"pushpull";b.$paginatediv=a("#"+b.galleryid+"-paginate");if(b.autostep)b.autostep.pause+=b.panelbehavior.speed;b.onpanelclick=typeof b.onpanelclick=="undefined"?function(a){}:b.onpanelclick;b.onslideaction=typeof b.onslide=="undefined"?function(){}:function(c){a(c).stop();b.onslide()};b.oninit=typeof b.oninit=="undefined"?function(){}:b.oninit;b.beltoffset=stepcarousel.getCSSValue(b.$belt.css("marginLeft"));b.statusvars=b.statusvars||[];b.$statusobjs=[a("#"+b.statusvars[0]),a("#"+b.statusvars[1]),a("#"+b.statusvars[2])];b.currentpanel=0;stepcarousel.configholder[b.galleryid]=b;if(b.contenttype[0]=="ajax"&&typeof b.contenttype[1]!="undefined")stepcarousel.getremotepanels(a,b);else stepcarousel.alignpanels(a,b)},resetsettings:function(a,b){b.$gallery.unbind();b.$belt.stop();b.$panels.remove();if(b.$leftnavbutton){b.$leftnavbutton.remove();b.$rightnavbutton.remove()}if(b.$paginatediv.length==1){b.$paginatediv.unbind();b.pageinfo.$controls.eq(0).attr("src",b.pageinfo.srcs[0]).removeAttr("data-index").removeAttr("data-moveto").removeAttr("title").end().slice(1).remove()}if(b.autostep)b.autostep.status=null;if(b.panelbehavior.persist){stepcarousel.setCookie(window[b.galleryid+"persist"],0)}},setup:function(a){jQuery(document).ready(function(b){a.$gallery=b("#"+a.galleryid);stepcarousel.init(b,a)});jQuery(window).bind("unload",function(){stepcarousel.resetsettings($,a);if(a.panelbehavior.persist)stepcarousel.setCookie(a.galleryid+"persist",a.currentpanel);jQuery.each(a,function(a,b){b=null});a=null})}};$=jQuery