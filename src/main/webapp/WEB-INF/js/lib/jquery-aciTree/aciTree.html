<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="language" content="en" />
        <meta name="robots" content="index, follow" />
        <title>aciTree demo - A treeview control with jQuery</title>
        <meta name="description" content="A demo to show you how aciTree can be used, check the plugin page to see all the functions exposed by the API" />
        <meta name="keywords" content="aciTree, treeview, control, tree view, javascript, jQuery" />
        <link rel="stylesheet" type="text/css" href="css/aciTree.css" media="all" />
        <link rel="stylesheet" type="text/css" href="css/demo.css" media="all" />
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery.aciPlugin.min.js"></script>
        <script type="text/javascript" src="js/jquery.aciTree.core.js"></script>
        <script type="text/javascript" src="js/jquery.aciTree.utils.js"></script>
        <script type="text/javascript" src="js/jquery.aciTree.selectable.js"></script>
        <script type="text/javascript" src="js/jquery.aciTree.checkbox.js"></script>
        <script type="text/javascript" src="js/jquery.aciTree.radio.js"></script>
    </head>
    <body>

        <div>

            <p>Here you have a simple implementation of a file system tree (you can find a simple PHP implementation in the download).</p>

            <p>See a checkbox tree demo <a href="aciTree-checkbox.html" target="_blank" title="aciTree with checkboxes">here</a></p>
            <p>See a radio-button tree demo <a href="aciTree-radio.html" target="_blank" title="aciTree with radio-buttons">here</a></p>

            <p>Note: in this demo the node loading it's made with a delay so you can see the loading animation. If you want you can remove the delay from the <i>PHP</i> script ;) ...</p>

            <p id="info">Hover over a tree item to show his info ...</p>

            <div id="tree" class="aciTree"><div class="eyes"></div><div>
                    <a style="font-size:10px" href="/source/php/niceJson.php?file=source/aciTree/php/aciTree.php?branch=" title="See the JSON data" target="_blank">see the JSON behind this tree</a>
                    <br />Anything here or just remove</div></div>

            <div class="form">
                <form action="" enctype="application/x-www-form-urlencoded" method="post" target="_self">
                    <table cellspacing="0" cellpadding="10" border="0"><tr><td width="300">
                                <p>Show Branches: <label><input type="radio" name="branches" value="1" /> Yes</label>
                                    <label><input type="radio" name="branches" value="0" /> No</label></p>
                                <p>Use Animations: <label><input type="radio" name="animate" value="1" /> Yes</label>
                                    <label><input type="radio" name="animate" value="0" /> No</label></p>
                                <p>Expand All: <label><input type="radio" name="expand" value="1" /> Yes</label>
                                    <label><input type="radio" name="expand" value="0" /> No</label></p>
                                <p>Collapse All: <label><input type="radio" name="collapse" value="1" /> Yes</label>
                                    <label><input type="radio" name="collapse" value="0" /> No</label></p>
                                <p>Unique on Open: <label><input type="radio" name="unique" value="1" /> Yes</label>
                                    <label><input type="radio" name="unique" value="0" /> No</label></p>
                                <p>Empty on Close: <label><input type="radio" name="empty" value="1" /> Yes</label>
                                    <label><input type="radio" name="empty" value="0" /> No</label></p>
                                <p>Selectable: <label><input type="radio" name="selectable" value="1" /> Yes</label>
                                    <label><input type="radio" name="selectable" value="0" /> No</label></p>
                                <p>Text Selection: <label><input type="radio" name="textSelection" value="1" /> Enabled</label>
                                    <label><input type="radio" name="textSelection" value="0" /> Disabled</label></p>

                                <p>Checkboxes: <label><input type="radio" name="checkbox" value="1" /> Yes</label>
                                    <label><input type="radio" name="checkbox" value="0" /> No</label></p>
                                <p>Radio Buttons: <label><input type="radio" name="radio" value="1" /> Yes</label>
                                    <label><input type="radio" name="radio" value="0" /> No</label></p>

                                <p><input id="destroy" type="button" value="Destroy" />
                                    <input id="init" type="button" value="Init with AJAX" /></p>
                                <p><input id="init_data" type="button" value="Init from Data" />
                                    <input id="init_huge" type="button" value="Init Huge" />
                                    <input id="clear_log" type="button" value="Clear Log" /></p>
                                <p id="selected">Select a Tree item or the Tree itself (<span style="color:red">note</span>)!</p>
                                <p>Mode: <label><input type="radio" name="addMode" value="before" /> Add Before</label>
                                    <label><input type="radio" name="addMode" value="after" checked="checked" /> Add After</label></p>
                                <p><input id="addFile" type="button" value="Add File" />
                                    <input id="addFolder" type="button" value="Add Folder" />
                                    <input id="addChilds" type="button" value="Add Childrens" /></p>
                                <p><input id="unload" type="button" value="Unload Folder/Tree" />
                                    <input id="load" type="button" value="Load Folder/Tree" /></p>
                                <p><input id="setFile" type="button" value="Set as File" />
                                    <input id="setFolder" type="button" value="Set as Folder" />
                                    <input id="remove" type="button" value="Remove" /></p>
                            </td><td>
                                <p>Set Icon: <select id="setIcon"><option value="">-- choose --</option>
                                        <option value="file">File</option><option value="folder">Folder</option><option value="remove">Remove</option></select></p>

                                <p>Set Checkbox: <select id="setCheckbox"><option value="">-- choose --</option>
                                        <option value="yes">Yes</option><option value="No">No</option></select></p>
                                <p>Set Radio: <select id="setRadio"><option value="">-- choose --</option>
                                        <option value="yes">Yes</option><option value="No">No</option></select></p>

                                <p>Node: <input id="open" type="button" value="Open" /> <input id="close" type="button" value="Close" />
                                    <input id="toggle" type="button" value="Toggle" /></p>
                                <p>Burn some CPU: <input id="addFile1k" type="button" value="Add 1k Files" />
                                    <input id="addFolder1k" type="button" value="Add 1k Folders" /></p>
                                <p>Using 'branch': <input id="branch_open" type="button" value="Open All" /> <input id="branch_close" type="button" value="Close All" />
                                    <input id="branch_toggle" type="button" value="Toggle All" /></p>
                                <p>Search ID: <input type="text" name="item_id" value="/Item 1/document 1.txt" size="23" />
                                    <input id="set_visible" type="button" value="Set Visible" /></p>
                                <p>Search Params: <label><input type="checkbox" name="search_path" value="1" /> Use Path</label>
                                    <label><input type="checkbox" name="search_load" value="1" /> Use Load</label></p>
                                <p><label>Item Content:</label>
                                    <textarea name="item_cnt">a long item text haha this is a looooong text to be set for a item<br />with a brake...<br />more lines</textarea>
                                    <input id="set_cnt" type="button" value="Set Content" /></p>
                                <p>Using 'update': <input id="update_file" type="button" value="Update as File" />
                                    <input id="update_folder" type="button" value="Update as Folder" /></p>
                                <p>Move Item: <input id="move_up" type="button" value="Up" /> <input id="move_down" type="button" value="Down" />
                                    <input id="move_first" type="button" value="First Position" /> <input id="move_last" type="button" value="Last Position" /></p>
                                <p>Swap Item (by ID): <input type="text" name="swap1" value="/document b.txt" /> <br /> with
                                    <input type="text" name="swap2" value="/Item 3" /> <input id="swap" type="button" value="Swap" /></p>
                            </td></tr></table>
                </form>
            </div>

            <div class="log">Tree Log... <a class="clear_log" style="font-size:10px" href="#" title="Clear the LOG" target="_blank">clear log</a>
                <div></div></div>

            <p style="clear:both"><br /><span style="color:red">Note</span>: the selected pink item does not have anything to do with the <i>selectable</i> option, it's there just to be able to 'select' the
                entire tree (not only a item).<br />All item based functions are made - in this demo - to run against the pink selected item (and not the <i>real</i> selected item - when the
                selectable option is used).</p>

        </div>

        <script language="javascript" type="text/javascript">

            $(function(){

                // Tree API
                var treeApi;

                // if we want to init without one initial AJAX request :)
                var rootData = [{"id":"\/Item 1","item":"Item 1 - From rootData","props":{"isFolder":true,"open":false,"icon":"folder"},"items":[]},
                    {"id":"\/Item 2","item":"Item 2 - very long item text<br />with a brake","props":{"isFolder":true,"open":false,"icon":"folder"},"items":[]},
                    {"id":"\/Item 3","item":"Item 3","props":{"isFolder":false,"open":false,"icon":"folder"},"items":[]},
                    {"id":"\/Item 4","item":"Item 4","props":{"isFolder":false,"open":false,"icon":"folder"},"items":[]},
                    {"id":"\/Item 5","item":"Item 5","props":{"isFolder":true,"open":false,"icon":"folder"},"items":[]},
                    {"id":"\/Item 6","item":"Item 6","props":{"isFolder":false,"open":false,"icon":"folder"},"items":[]},
                    {"id":"\/Item 7","item":"Item 7","props":{"isFolder":true,"open":false,"icon":"folder"},"items":[]},
                    {"id":"\/Item 8","item":"Item 8","props":{"isFolder":true,"open":false,"icon":"folder"},"items":[]},
                    {"id":"\/document a.txt","item":"document a.txt","props":{"isFolder":false,"open":false,"icon":"file"},"items":[]},
                    {"id":"\/document b.txt","item":"document b.txt","props":{"isFolder":false,"open":false,"icon":"file"},"items":[]},
                    {"id":"\/document c.txt","item":"document c.txt","props":{"isFolder":false,"open":false,"icon":"file"},"items":[]}];

                // init the Tree
                function initTree(type){
                    treeApi = $('#tree').aciTree({
                        jsonUrl: (type == 'huge') ? 'php/hugeTree.php?branch=' : 'php/aciTree.php?branch=',
                        rootData: (type == 'data') ? rootData : null,
                        callbacks: {
                            item: function(parent, item, itemData, level){
                                // a custom item implementation to show the tree level
                                this.setText(item, itemData.item + ' (' + level + ')');
                            }
                        }
                    }).aciTree('api');
                }

                var log = $('.log div');

                var eye = $('.eyes'), eyes = 0;

                // a little animation :)
                function showEyes(){
                    if (eyes > 2){
                        eyes = 0;
                    }
                    eye.css('background-position', '0 -' + (eyes * 48) + 'px');
                }

                $('#tree').scroll(function(){
                    eye.css('top', $(this).scrollTop() + 'px');
                });

                // show tree events
                $('#tree').on('acitree', function(e, api, item, data){
                    if (api.isLocked()){
                        // prevent write to log on init/destroy
                        return;
                    }
                    switch (data.event){
                        case 'idset':
                            log.prepend('<p>' + data.event + ' [' + api.getId(item) + '] old ID: [' + data.oldId + ']</p>');
                            break;
                        case 'itemset':
                            log.prepend('<p>' + data.event + ' [' + api.getId(item) + '] old text: [' + data.oldText + ']</p>');
                            break;
                        case 'swapped':
                            log.prepend('<p>' + data.event + ' [' + api.getId(data.item1) + '] <=> [' + api.getId(data.item2) + ']</p>');
                            break;
                        case 'movedup':
                        case 'moveddown':
                        case 'movedfirst':
                        case 'movedlast':
                            log.prepend('<p>' + data.event + ' [' + api.getId(item) + '] old index: [' + data.oldIndex + ']</p>');
                            // make it visible ;)
                            api.setVisible(item);
                            break;
                        default:
                            if (item){
                                log.prepend('<p>' + data.event + ' [' + api.getId(item) + ']</p>');
                            } else {
                                log.prepend('<p>' + data.event + ' [tree]</p>');
                            }
                            if (data.event == 'toggled'){
                                eyes++;
                                showEyes();
                            }
                    }
                });

                // do it ;-)
                initTree();

                // a little debug info tool :)
                function debug (item){
                    var info = '';
                    info += 'getId: [' + treeApi.getId(item) + ']\n';
                    info += 'getText: "' + treeApi.getText(item) + '"\n';
                    info += 'level: ' + treeApi.level(item) + '\n';
                    info += 'getIndex: ' + treeApi.getIndex(item) + '\n';
                    info += 'isFile: ' + treeApi.isFile(item) + '\n';
                    info += 'isFolder: ' + treeApi.isFolder(item) + ' (open: ' + treeApi.isOpen(item) + ')\n';
                    info += 'wasLoad: ' + treeApi.wasLoad(item) + '\n';
                    info += 'hasParent: ' + treeApi.hasParent(item) + '\n';
                    info += 'parent: [' + treeApi.getId(treeApi.parent(item)) + ']\n';
                    info += 'path: [root] ';
                    treeApi.path(item).each(function(){
                        info += '[' + treeApi.getId($(this)) + '] ';
                    });
                    info += '\n';
                    info += 'hasSiblings: ' + treeApi.hasSiblings(item) + ' count: #' + treeApi.siblings(item).length + '\n';
                    info += 'hasPrev: ' + treeApi.hasPrev(item) + ' [' + treeApi.getId(treeApi.prev(item)) + ']\n';
                    info += 'hasNext: ' + treeApi.hasNext(item) + ' [' + treeApi.getId(treeApi.next(item)) + ']\n';
                    var childs = treeApi.childrens(item);
                    info += 'hasChildrens: ' + treeApi.hasChildrens(item) + ' count: #' + childs.length +
                        ' folders: #' + treeApi.folders(childs).length + ' (open: #' + treeApi.folders(childs, true).length +
                        ' closed: #' + treeApi.folders(childs, false).length + ') files: #' + treeApi.files(childs).length + '\n';
                    info += 'first [' + treeApi.getId(treeApi.first(item)) + ']\n';
                    info += 'last [' + treeApi.getId(treeApi.last(item)) + ']\n';
                    info += 'childrens: total: #' + treeApi.childrens(item, true).length + '\n';
                    return info;
                }

                // keep the last element
                var _g_tree = null;

                // ensure info changes
                window.setInterval(function(){ _g_tree = null; }, 500);

                // output some info
                function getDebug(element){
                    if (_g_tree == element){
                        return;
                    }
                    _g_tree = element;
                    var item = treeApi.itemFrom(element);
                    if (!item.length){
                        item = null;
                    }
                    $('#info').html(debug(item).replace(/\n/g, '<br />'));
                }

                // refresh on item 'mouseover'
                $('#tree').on('mouseover', '.aciTreeLi', function(e){
                    getDebug(e.target);
                    return false;
                }).bind('mouseover', function(e){
                    getDebug(e.target);
                });

                // get Tree init options
                var options = $('#tree').aciTree('options');

                // init FORM based on options
                $('[name=branches][value=' + ($('#tree').hasClass('aciTreeNoBranches') ? 0 : 1) + ']').prop('checked', true);
                $('[name=animate][value=' + (options.show ? 1 : 0) + ']').prop('checked', true);
                $('[name=expand][value=' + (options.expand ? 1 : 0) + ']').prop('checked', true);
                $('[name=collapse][value=' + (options.collapse ? 1 : 0) + ']').prop('checked', true);
                $('[name=empty][value=' + (options.empty ? 1 : 0) + ']').prop('checked', true);
                $('[name=unique][value=' + (options.unique ? 1 : 0) + ']').prop('checked', true);
                $('[name=selectable][value=' + (options.selectable ? 1 : 0) + ']').prop('checked', true);
                $('[name=textSelection][value=' + (options.textSelection ? 1 : 0) + ']').prop('checked', true);
                $('[name=checkbox][value=' + (options.checkbox ? 1 : 0) + ']').prop('checked', true);
                $('[name=radio][value=' + (options.radio ? 1 : 0) + ']').prop('checked', true);
                $('#setCheckbox').attr('disabled', !options.checkbox);
                $('#setRadio').attr('disabled', !options.radio);

                // update options

                $('[name=animate]').click(function(){
                    if ($(this).val() == 1){
                        treeApi.option('show', {
                            props: {
                                'height': 'show'
                            },
                            duration: 'medium',
                            easing: 'linear'
                        });
                        treeApi.option('hide', {
                            props: {
                                'height': 'hide'
                            },
                            duration: 'medium',
                            easing: 'linear'
                        });
                        treeApi.option('view', {
                            duration: 'medium',
                            easing: 'linear'
                        });
                    } else {
                        treeApi.option('show', null);
                        treeApi.option('hide', null);
                        treeApi.option('view', null);
                    }
                });

                $('[name=branches]').click(function(){
                    $('#tree').toggleClass('aciTreeNoBranches', $(this).val() == 0);
                });

                $('[name=checkbox]').click(function(){
                    $('#setCheckbox').attr('disabled', $(this).val() != 1);
                });

                $('[name=radio]').click(function(){
                    $('#setRadio').attr('disabled', $(this).val() != 1);
                });

                $('[name=expand],[name=collapse],[name=empty],[name=unique],[name=selectable],[name=textSelection],[name=checkbox],[name=radio]').click(function(){
                    $('#tree').aciTree('option', $(this).prop('name'), $(this).val() == 1);
                });

                // FORM button functions

                $('#destroy').click(function(){
                    $('#tree').aciTree('destroy');
                });

                // update init options based on inputs
                function updateOptions(){
                    $('[name=expand]:checked,[name=collapse]:checked,[name=empty]:checked,[name=unique]:checked,[name=selectable]:checked,[name=textSelection]:checked,[name=checkbox]:checked,[name=radio]:checked').each(function(){
                        $.fn.aciTree.defaults[$(this).prop('name')] = $(this).val() == 1;
                    });
                }

                $('#init').click(function(){
                    // update options
                    updateOptions();
                    initTree();
                });

                $('#init_data').click(function(){
                    // update options
                    updateOptions();
                    initTree('data');
                });

                $('#init_huge').click(function(){
                    // update options
                    updateOptions();
                    initTree('huge');
                });

                $('#clear_log,.clear_log').click(function(){
                    $('.log div').html('');
                    return false;
                });

                // keep the last selected
                var _g_sel = null;

                // selected state for the Tree
                $(document).on('click', '#tree', function(){
                    $('#tree').find('.selected').removeClass('selected');
                    $(this).addClass('selected');
                    _g_sel = this;
                });

                // selected state for the Tree items
                $('#tree').on('click', '.aciTreeItem', function(e){
                    $('#tree').removeClass('selected').find('.selected').removeClass('selected');
                    $(this).addClass('selected');
                    _g_sel = this;
                    e.stopPropagation();
                });

                // few little helpers ->

                function isTree(){
                    return _g_sel && (_g_sel == $('#tree').get(0));
                }

                function isItem(){
                    if (_g_sel){
                        var item = treeApi.itemFrom(_g_sel);
                        // itemFrom can return NULL or empty set
                        if (item && item.length){
                            return item;
                        }
                    }
                    return null;
                }

                function warn(item){
                    if (item){
                        alert('Please select a Tree item (with a click)!');
                    } else {
                        alert('Please select a Tree item or the Tree itself (with a click)!');
                    }
                }

                var fileIndex = 0;

                // get new File item data
                function newFile(){
                    var itemData = {
                        id: 'a_new_File_ID_' + fileIndex,
                        item: 'File name ' + fileIndex,
                        props: {
                            isFolder: false,
                            icon: 'file'
                        }
                    };
                    fileIndex++;
                    return itemData;
                }

                var folderIndex = 0;

                // get new Folder item data
                function newFolder(){
                    var itemData = {
                        id: 'a_new_Folder_ID_' + folderIndex,
                        item: 'Folder name ' + folderIndex,
                        props: {
                            isFolder: null,
                            open: false,
                            icon: 'folder'
                        }/*,
                        items: []*/
                    };
                    folderIndex++;
                    return itemData;
                }

                // a new Tree item or items (after or before a item)
                function treeAddItem(item, itemData){
                    var before = $('[name=addMode]:checked').val() == 'before';
                    if (before){
                        treeApi.before(item.first(), {
                            itemData: itemData
                        });
                    } else {
                        treeApi.after(item.last(), {
                            itemData: itemData
                        });
                    }
                }

                // <- few little helpers

                // do something with the selected item ;-)

                $('#addFile').click(function(){
                    if (isTree()){
                        // the Tree is selected, just add a File on the first/last position
                        var childs = treeApi.childrens();
                        if (childs.length){
                            // Tree already has some items on ROOT
                            treeAddItem(childs, newFile());
                        } else {
                            // no Tree items on ROOT
                            treeApi.append(null, {
                                itemData: newFile()
                            });
                        }
                    } else {
                        var item = isItem();
                        if (item){
                            // a Tree item is selected, add a File before/after it
                            treeAddItem(item, newFile());
                        } else {
                            warn();
                        }
                    }
                });

                $('#addFolder').click(function(){
                    if (isTree()){
                        // the Tree is selected, just add a Folder on the first/last position
                        var childs = treeApi.childrens();
                        if (childs.length){
                            // Tree already has some items on ROOT
                            treeAddItem(childs, newFolder());
                        } else {
                            // no Tree items on ROOT
                            treeApi.append(null, {
                                itemData: newFolder()
                            });
                        }
                    } else {
                        var item = isItem();
                        if (item){
                            // a Tree item is selected, add a Folder before/after it
                            treeAddItem(item, newFolder());
                        } else {
                            warn();
                        }
                    }
                });

                $('#addChilds').click(function(){
                    if (isTree()){
                        // the Tree is selected, just add a Folder+File
                        treeApi.append(null, [newFolder(), newFile()]);
                    } else {
                        var item = isItem();
                        if (item){
                            // a Tree item is selected, add a Folder+File
                            // note: this should be a Tree Folder (but no need to check, does nothing for a Tree File)
                            treeApi.append(item, {
                                itemData: [newFolder(), newFile()]
                            });
                            if (!treeApi.isFolder(item)){
                                alert('Childrens can be added only on Tree Folders!');
                            }
                        } else {
                            warn();
                        }
                    }
                });

                $('#unload').click(function(){
                    if (isTree()){
                        // the Tree is selected, unload it all >:)
                        treeApi.unload();
                    } else {
                        var item = isItem();
                        if (item){
                            // a Tree item is selected, unload the Folder
                            // note: this should be a Tree Folder (but no need to check, does nothing for a Tree File)
                            treeApi.unload(item);
                            if (!treeApi.isFolder(item)){
                                alert('Only folders can be unloaded!');
                            }
                        } else {
                            warn();
                        }
                    }
                });

                $('#load').click(function(){
                    if (isTree()){
                        // the Tree is selected, load the ROOT
                        if (treeApi.wasLoad()){
                            alert('The ROOT was loaded already, nothing to do!');
                        }
                        treeApi.ajaxLoad();
                    } else {
                        var item = isItem();
                        if (item){
                            // a Tree item is selected, load the Folder
                            // note: this should be a Tree Folder (but no need to check, does nothing for a Tree File)
                            if (treeApi.isFolder(item)){
                                if (treeApi.wasLoad(item)){
                                    alert('The Folder was loaded already, nothing to do!');
                                }
                            } else {
                                alert('Only Tree Folders can be loaded!');
                            }
                            treeApi.ajaxLoad(item, {
                                success: function(){ alert('Tree Folder load complete!'); }
                            });
                        } else {
                            warn();
                        }
                    }
                });

                $('#setFile').click(function(){
                    var item = isItem();
                    if (item){
                        // a Tree item is selected, set the Folder as a File
                        // note: this should be a Tree Folder (but no need to check, does nothing for a Tree File)
                        if (!treeApi.isFolder(item)){
                            alert('Only Tree Folders can be changed to a File!');
                        }
                        treeApi.setFile(item, {
                            success: function(){
                                // if was set then change the icon
                                this.setIcon(item, 'file');
                            }
                        });
                    } else {
                        warn(true);
                    }
                });

                $('#setFolder').click(function(){
                    var item = isItem();
                    if (item){
                        // a Tree item is selected, set the File as a Folder
                        // note: this should be a Tree File (but no need to check, does nothing for a Tree Folder)
                        if (!treeApi.isFile(item)){
                            alert('Only Tree Files can be changed to a Folder!');
                        }
                        treeApi.setFolder(item, {
                            success: function(){
                                // if was set then change the icon
                                this.setIcon(item, 'folder');
                            }
                        });
                    } else {
                        warn(true);
                    }
                });

                $('#remove').click(function(){
                    if (isTree()){
                        // the Tree is selected, just remove all ROOT items
                        treeApi.unload();
                    } else {
                        var item = isItem();
                        if (item){
                            // a Tree item is selected, remove it
                            treeApi.remove(item);
                        } else {
                            warn();
                        }
                    }
                });

                $('#setIcon').change(function(){
                    var item = isItem();
                    if (item){
                        // note: the Tree does not interpret the ICON in any way
                        // if it looks like a Folder it does not mean it's a Folder (same goes for a Tree File)
                        treeApi.setIcon(item, ($(this).val() == 'remove') ? null : $(this).val());
                    } else {
                        warn(true);
                    }
                    $(this).val('');
                });

                $('#setCheckbox').change(function(){
                    var item = isItem();
                    if (item){
                        if ($(this).val() == 'yes'){
                            // make sure no radio
                            treeApi.setRadio(item, false);
                            treeApi.setCheckbox(item, true);
                        } else {
                            treeApi.setCheckbox(item, false);
                        }
                    } else {
                        warn(true);
                    }
                    $(this).val('');
                });

                $('#setRadio').change(function(){
                    var item = isItem();
                    if (item){
                        if ($(this).val() == 'yes'){
                            // make sure no checkbox
                            treeApi.setCheckbox(item, false);
                            treeApi.setRadio(item, true);
                        } else {
                            treeApi.setRadio(item, false);
                        }
                    } else {
                        warn(true);
                    }
                    $(this).val('');
                });

                $('#open').click(function(){
                    var item = isItem();
                    if (item){
                        // open the Folder (does nothing if it's not a Folder)
                        treeApi.open(item, {
                            expand: treeApi.options().expand
                        });
                        if (!treeApi.isFolder(item)){
                            alert('Only Tree Folders can be opened!');
                        }
                    } else {
                        warn(true);
                    }
                });

                $('#close').click(function(){
                    var item = isItem();
                    if (item){
                        // open the Folder (does nothing if it's not a Folder)
                        treeApi.close(item, {
                            collapse: treeApi.options().collapse
                        });
                        if (!treeApi.isFolder(item)){
                            alert('Only Tree Folders can be closed!');
                        }
                    } else {
                        warn(true);
                    }
                });

                $('#toggle').click(function(){
                    var item = isItem();
                    if (item){
                        // open the Folder (does nothing if it's not a Folder)
                        treeApi.toggle(item, {
                            expand: treeApi.options().expand,
                            collapse: treeApi.options().collapse
                        });
                        if (!treeApi.isFolder(item)){
                            alert('Only Tree Folders can be opened or closed!');
                        }
                    } else {
                        warn(true);
                    }
                });

                // time to burn your CPU ;))

                $('#addFile1k').click(function(){
                    var list = [];
                    for(var i = 0; i < 1000; i++){
                        list[list.length] = newFile();
                    }
                    if (isTree()){
                        // the Tree is selected, just add a File on the first/last position
                        var childs = treeApi.childrens();
                        if (childs.length){
                            // Tree already has some items on ROOT
                            treeAddItem(childs, list);
                        } else {
                            // no Tree items on ROOT
                            treeApi.append(null, {
                                itemData: list
                            });
                        }
                    } else {
                        var item = isItem();
                        if (item){
                            // a Tree item is selected, add a File before/after it
                            treeAddItem(item, list);
                        } else {
                            warn();
                        }
                    }
                });

                $('#addFolder1k').click(function(){
                    var list = [];
                    for(var i = 0; i < 1000; i++){
                        list[list.length] = newFolder();
                    }
                    if (isTree()){
                        // the Tree is selected, just add a Folder on the first/last position
                        var childs = treeApi.childrens();
                        if (childs.length){
                            // Tree already has some items on ROOT
                            treeAddItem(childs, list);
                        } else {
                            // no Tree items on ROOT
                            treeApi.append(null, {
                                itemData: list
                            });
                        }
                    } else {
                        var item = isItem();
                        if (item){
                            // a Tree item is selected, add a Folder before/after it
                            treeAddItem(item, list);
                        } else {
                            warn();
                        }
                    }
                });

                // custom stuff :) using 'branch' ...
                // note that 'doOpen' and 'doClose' already have the 'propagate' option and they are optimized for large branches
                // this is just to show how a tree branch can be processed
                // including starting from ROOT; in this way you can do your custom thing with more ease
                // note that 'branch' will load the nodes if 'load' is set to TRUE (we need to load a node before we can open it)

                function checkBusy(){
                    if (treeApi.isBusy()){
                        alert("The treeview is busy right now.\nPlease wait while it's finishing his thing :)");
                        return true;
                    }
                    return false;
                }

                // custom open magic happens here
                var branch_open = function(api, item){
                    if (api.isFolder(item)){
                        // check if is a folder just to avoid error notification
                        api.open(item);
                    }
                };

                $('#branch_open').click(function(){
                    if (checkBusy()){
                        return;
                    }
                    if (isTree()){
                        treeApi.branch(null, branch_open, true);
                    } else {
                        var item = isItem();
                        if (item){
                            // need this cause 'branch' is processing only childs (item is not included)
                            treeApi.open(item);
                            treeApi.branch(item, branch_open, true);
                        } else {
                            warn();
                        }
                    }
                });

                // custom close magic happens here
                var branch_close = function(api, item){
                    if (api.isFolder(item)){
                        // check if is a folder just to avoid error notification
                        api.close(item);
                    }
                };

                $('#branch_close').click(function(){
                    if (checkBusy()){
                        return;
                    }
                    if (isTree()){
                        treeApi.branch(null, branch_close);
                    } else {
                        var item = isItem();
                        if (item){
                            // need this cause 'branch' is processing only childs (item is not included)
                            treeApi.close(item);
                            treeApi.branch(item, branch_close);
                        } else {
                            warn();
                        }
                    }
                });

                // custom toggle magic happens here
                var branch_toggle = function(api, item){
                    if (api.isFolder(item)){
                        // check if is a folder just to avoid error notification
                        api.toggle(item);
                    }
                };

                $('#branch_toggle').click(function(){
                    if (checkBusy()){
                        return;
                    }
                    if (isTree()){
                        treeApi.branch(null, branch_toggle, true);
                    } else {
                        var item = isItem();
                        if (item){
                            // need this cause 'branch' is processing only childs (item is not included)
                            treeApi.toggle(item);
                            treeApi.branch(item, branch_toggle, true);
                        } else {
                            warn();
                        }
                    }
                });

                // search by ID and make item visible

                function wasFound(id, item){
                    var path = '[root] ';
                    treeApi.path(item).each(function(){
                        path += '[' + treeApi.getId($(this)) + '] ';
                    });
                    // set item visible :)
                    treeApi.setVisible(item, {
                        success: function(){
                            alert('The ID [' + id + '] has been found!\nThe path is: ' + path);
                        }
                    });
                }

                function notFound(id){
                    alert('The ID [' + id + '] has not been found!');
                }

                $('#set_visible').click(function(){
                    var id = $('[name=item_id]').val();
                    var path = $('[name=search_path]').is(':checked');
                    var load = $('[name=search_load]').is(':checked');
                    if (path && load){
                        // we need to use callbacks with 'load' cause it's async
                        treeApi.searchId(id, path, load, {
                            success: function(item){
                                wasFound(id, item);
                            },
                            fail: function(item){
                                notFound(id);
                            }
                        });
                    } else {
                        var found = treeApi.searchId(id, path);
                        if (found.length){
                            wasFound(id, found);
                        } else {
                            notFound(id);
                        }
                    }
                });

                // set item content

                $('#set_cnt').click(function(){
                    var cnt = $('[name=item_cnt]').val();
                    if (cnt.length){
                        var item = isItem();
                        if (item){
                            treeApi.setText(item, cnt);
                        } else {
                            warn(true);
                        }
                    } else {
                        alert('Please enter some content do set the item to!');
                    }
                });

                // update items

                $('#update_file').click(function(){
                    var item = isItem();
                    if (item){
                        treeApi.update(item, {
                            itemData: {
                                id: 'a_new_file_id',
                                item: 'usign [update] to set a item as a file',
                                props: {
                                    icon: 'file'
                                }
                            }
                        });
                    } else {
                        warn(true);
                    }
                });

                $('#update_folder').click(function(){
                    var item = isItem();
                    if (item){
                        treeApi.update(item, {
                            itemData: {
                                id: 'a_new_folder_id',
                                item: 'usign [update] to set a item as a folder',
                                props: {
                                    isFolder: true,
                                    icon: 'folder'
                                },
                                items: rootData // using rootData to init the folder
                            }
                        });
                    } else {
                        warn(true);
                    }
                });

                // move items

                $('#move_up').click(function(){
                    var item = isItem();
                    if (item){
                        treeApi.moveUp(item);
                    } else {
                        warn(true);
                    }
                });

                $('#move_down').click(function(){
                    var item = isItem();
                    if (item){
                        treeApi.moveDown(item);
                    } else {
                        warn(true);
                    }
                });

                $('#move_first').click(function(){
                    var item = isItem();
                    if (item){
                        treeApi.moveFirst(item);
                    } else {
                        warn(true);
                    }
                });

                $('#move_last').click(function(){
                    var item = isItem();
                    if (item){
                        treeApi.moveLast(item);
                    } else {
                        warn(true);
                    }
                });

                // swap items by ID (if found)

                $('#swap').click(function(){
                    var swap1 = $('[name=swap1]').val();
                    var swap2 = $('[name=swap2]').val();
                    var item1 = treeApi.searchId(swap1);
                    var item2 = treeApi.searchId(swap2);
                    if (!item1.length){
                        alert('First item ID not found!');
                    } else if (!item2.length){
                        alert('Second item ID not found!');
                    } else {
                        treeApi.swap(item1, item2);
                    }
                });

            });

        </script>

    </body>
</html>